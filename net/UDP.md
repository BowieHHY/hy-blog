### UDP

> 用户数据报协议（User Datagram Protocol），是一种无连接的传输层协议，提供面向事务的简单的不可靠信息传输服务

> *位于传输层，同样的还有 TCP协议，一样用于处理数据包，不同的是TCP是面向连接的*

#### 面向无连接

UDP 是一个无连接协议，传输数据之前源端和终端不建立连接，当想传送时就简单地抓取来自应用程序的数据，并尽可能快地把它扔到网络里；

UDP 只是数据报文的搬运工，不会对数据报文进行任何拆分和拼接操作，不需要维护连接的状态，也不保证有序并且不丢失的传递到对端，相对会比较轻便；

UDP 传输数据的速度仅仅受应用程序生成的速度、计算机的能力和传输带宽的限制。

具体来说就是：

- 在发送端，应用层将数据传递给传输层的 UDP 协议，UDP 只会给数据增加一个 UDP 头标识下是 UDP 协议，然后就传递给网络层了
- 在接收端，网络层将数据传递给传输层，UDP 只去除 IP 报文头就传递给应用层，不会任何拼接操作

#### 不可靠性

UDP 的不可靠体现在无连接上，想发就发，并且收到什么数据就传递什么数据，并且也不会备份数据，发送数据也不会关心对方是否已经正确接受到数据。

再者网络环境时好时坏，但是 UDP 因为没有拥塞控制，一直会以恒定的速度发送数据。即使网络条件不好，也不会对发送速率进行调整。这样实现的弊端就是在网络条件不好的情况下可能会导致丢包，但是优点也很明显，在某些实时性要求高的场景（比如电话会议）就需要使用 UDP 而不是 TCP。

#### 高效

UDP 信息包的标题很短，只有8个字节，相比TCP的至少二十字节要少的多

![img](https://bkimg.cdn.bcebos.com/pic/78310a55b319ebc4c57a3f358c26cffc1e17161f?x-bce-process=image/resize,m_lfit,w_440,limit_1/format,f_auto)

UDP 头部主要包括：

- 两个端口号，源端口和目的端口
- 整个数据报文的长度
- 整个数据报文的检验和，该字段用于发现头部信息和数据中的错误

#### 传输方式

由于传输数据不建立连接，因此也就不需要维护连接状态，包括收发状态等，因此一台服务机可同时向多个客户机传输相同的消息。

也就是 UDP 提供了单播，多播，广播的功能。

#### 适合的场景

虽然UDP是一个不可靠的协议，但它是分发信息的一个理想协议。例如，在屏幕上报告股票市场、显示航空信息等等。UDP也用在[路由信息协议](https://baike.baidu.com/item/路由信息协议)RIP（Routing Information Protocol）中修改路由表。在这些应用场合下，如果有一个消息丢失，在几秒之后另一个新的消息就会替换它。UDP广泛用在多媒体应用中。

- 直播
- 王者荣耀
- 等等